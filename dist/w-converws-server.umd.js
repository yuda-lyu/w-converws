/*!
 * w-converws-server v1.0.33
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("ws")):"function"==typeof define&&define.amd?define(["ws"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-converws-server"]=e(t.ws)}(this,(function(t){"use strict";var e=Array.isArray,n="object"==typeof global&&global&&global.Object===Object&&global,r="object"==typeof self&&self&&self.Object===Object&&self,o=n||r||Function("return this")(),i=o.Symbol,u=Object.prototype,a=u.hasOwnProperty,c=u.toString,f=i?i.toStringTag:void 0;var s=Object.prototype.toString;var l="[object Null]",p="[object Undefined]",h=i?i.toStringTag:void 0;function y(t){return null==t?void 0===t?p:l:h&&h in Object(t)?function(t){var e=a.call(t,f),n=t[f];try{t[f]=void 0;var r=!0}catch(t){}var o=c.call(t);return r&&(e?t[f]=n:delete t[f]),o}(t):function(t){return s.call(t)}(t)}function v(t){return null!=t&&"object"==typeof t}var d="[object Symbol]";function g(t){return"symbol"==typeof t||v(t)&&y(t)==d}var b=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_=/^\w*$/;function j(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var m="[object AsyncFunction]",w="[object Function]",A="[object GeneratorFunction]",x="[object Proxy]";function O(t){if(!j(t))return!1;var e=y(t);return e==w||e==A||e==m||e==x}var S,U=o["__core-js_shared__"],B=(S=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"";var C=Function.prototype.toString;var z=/^\[object .+?Constructor\]$/,T=Function.prototype,P=Object.prototype,k=T.toString,E=P.hasOwnProperty,M=RegExp("^"+k.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $(t){return!(!j(t)||(e=t,B&&B in e))&&(O(t)?M:z).test(function(t){if(null!=t){try{return C.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function I(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return $(n)?n:void 0}var L=I(Object,"create");var F=Object.prototype.hasOwnProperty;var N=Object.prototype.hasOwnProperty;function R(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function D(t,e){return t===e||t!=t&&e!=e}function W(t,e){for(var n=t.length;n--;)if(D(t[n][0],e))return n;return-1}R.prototype.clear=function(){this.__data__=L?L(null):{},this.size=0},R.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},R.prototype.get=function(t){var e=this.__data__;if(L){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return F.call(e,t)?e[t]:void 0},R.prototype.has=function(t){var e=this.__data__;return L?void 0!==e[t]:N.call(e,t)},R.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=L&&void 0===e?"__lodash_hash_undefined__":e,this};var H=Array.prototype.splice;function q(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}q.prototype.clear=function(){this.__data__=[],this.size=0},q.prototype.delete=function(t){var e=this.__data__,n=W(e,t);return!(n<0)&&(n==e.length-1?e.pop():H.call(e,n,1),--this.size,!0)},q.prototype.get=function(t){var e=this.__data__,n=W(e,t);return n<0?void 0:e[n][1]},q.prototype.has=function(t){return W(this.__data__,t)>-1},q.prototype.set=function(t,e){var n=this.__data__,r=W(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};var V=I(o,"Map");function J(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function G(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}G.prototype.clear=function(){this.size=0,this.__data__={hash:new R,map:new(V||q),string:new R}},G.prototype.delete=function(t){var e=J(this,t).delete(t);return this.size-=e?1:0,e},G.prototype.get=function(t){return J(this,t).get(t)},G.prototype.has=function(t){return J(this,t).has(t)},G.prototype.set=function(t,e){var n=J(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};var K="Expected a function";function Q(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(K);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=t.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(Q.Cache||G),n}Q.Cache=G;var X,Y,Z,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/\\(\\)?/g,nt=(X=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,r,o){e.push(r?o.replace(et,"$1"):n||t)})),e},Y=Q(X,(function(t){return 500===Z.size&&Z.clear(),t})),Z=Y.cache,Y),rt=nt;var ot=1/0,it=i?i.prototype:void 0,ut=it?it.toString:void 0;function at(t){if("string"==typeof t)return t;if(e(t))return function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}(t,at)+"";if(g(t))return ut?ut.call(t):"";var n=t+"";return"0"==n&&1/t==-ot?"-0":n}function ct(t){return null==t?"":at(t)}function ft(t,n){return e(t)?t:function(t,n){if(e(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!g(t))||_.test(t)||!b.test(t)||null!=n&&t in Object(n)}(t,n)?[t]:rt(ct(t))}var st=1/0;function lt(t){if("string"==typeof t||g(t))return t;var e=t+"";return"0"==e&&1/t==-st?"-0":e}function pt(t,e,n){var r=null==t?void 0:function(t,e){for(var n=0,r=(e=ft(e,t)).length;null!=t&&n<r;)t=t[lt(e[n++])];return n&&n==r?t:void 0}(t,e);return void 0===r?n:r}var ht="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function yt(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){if(this instanceof t){var n=[null];return n.push.apply(n,arguments),new(Function.bind.apply(e,n))}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})})),n}var vt={};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,u){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,u),c=n?n+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,u=new Array(i);o<i;o++)u[o]=r[o].fn;return u},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,o,i,u){var a=n?n+t:t;if(!this._events[a])return!1;var c,f,s=this._events[a],l=arguments.length;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),l){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,r),!0;case 4:return s.fn.call(s.context,e,r,o),!0;case 5:return s.fn.call(s.context,e,r,o,i),!0;case 6:return s.fn.call(s.context,e,r,o,i,u),!0}for(f=1,c=new Array(l-1);f<l;f++)c[f-1]=arguments[f];s.fn.apply(s.context,c)}else{var p,h=s.length;for(f=0;f<h;f++)switch(s[f].once&&this.removeListener(t,s[f].fn,void 0,!0),l){case 1:s[f].fn.call(s[f].context);break;case 2:s[f].fn.call(s[f].context,e);break;case 3:s[f].fn.call(s[f].context,e,r);break;case 4:s[f].fn.call(s[f].context,e,r,o);break;default:if(!c)for(p=1,c=new Array(l-1);p<l;p++)c[p-1]=arguments[p];s[f].fn.apply(s[f].context,c)}}return!0},a.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||r&&a.context!==r||u(this,i);else{for(var c=0,f=[],s=a.length;c<s;c++)(a[c].fn!==e||o&&!a[c].once||r&&a[c].context!==r)&&f.push(a[c]);f.length?this._events[i]=1===f.length?f[0]:f:u(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&u(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}({get exports(){return vt},set exports(t){vt=t}});var dt=vt;function gt(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}var bt=9007199254740991;function _t(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=bt}function jt(t){return null!=t&&_t(t.length)&&!O(t)}var mt=9007199254740991,wt=/^(?:0|[1-9]\d*)$/;function At(t,e){var n=typeof t;return!!(e=null==e?mt:e)&&("number"==n||"symbol"!=n&&wt.test(t))&&t>-1&&t%1==0&&t<e}function xt(t,e,n){if(!j(n))return!1;var r=typeof e;return!!("number"==r?jt(n)&&At(e,n.length):"string"==r&&e in n)&&D(n[e],t)}var Ot=/\s/;var St=/^\s+/;function Ut(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Ot.test(t.charAt(e)););return e}(t)+1).replace(St,""):t}var Bt=NaN,Ct=/^[-+]0x[0-9a-f]+$/i,zt=/^0b[01]+$/i,Tt=/^0o[0-7]+$/i,Pt=parseInt;function kt(t){if("number"==typeof t)return t;if(g(t))return Bt;if(j(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=j(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ut(t);var n=zt.test(t);return n||Tt.test(t)?Pt(t.slice(2),n?2:8):Ct.test(t)?Bt:+t}var Et=1/0,Mt=17976931348623157e292;function $t(t){return t?(t=kt(t))===Et||t===-Et?(t<0?-1:1)*Mt:t==t?t:0:0===t?t:0}function It(t){var e=$t(t),n=e%1;return e==e?n?e-n:e:0}var Lt=Math.ceil,Ft=Math.max;var Nt=Array.prototype.join;function Rt(t,e){return null==t?"":Nt.call(t,e)}function Dt(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}var Wt,Ht=function(t,e,n){for(var r=-1,o=Object(t),i=n(t),u=i.length;u--;){var a=i[Wt?u:++r];if(!1===e(o[a],a,o))break}return t};function qt(t){return v(t)&&"[object Arguments]"==y(t)}var Vt=Object.prototype,Jt=Vt.hasOwnProperty,Gt=Vt.propertyIsEnumerable,Kt=qt(function(){return arguments}())?qt:function(t){return v(t)&&Jt.call(t,"callee")&&!Gt.call(t,"callee")},Qt=Kt;var Xt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Yt=Xt&&"object"==typeof module&&module&&!module.nodeType&&module,Zt=Yt&&Yt.exports===Xt?o.Buffer:void 0,te=(Zt?Zt.isBuffer:void 0)||function(){return!1},ee={};function ne(t){return function(e){return t(e)}}ee["[object Float32Array]"]=ee["[object Float64Array]"]=ee["[object Int8Array]"]=ee["[object Int16Array]"]=ee["[object Int32Array]"]=ee["[object Uint8Array]"]=ee["[object Uint8ClampedArray]"]=ee["[object Uint16Array]"]=ee["[object Uint32Array]"]=!0,ee["[object Arguments]"]=ee["[object Array]"]=ee["[object ArrayBuffer]"]=ee["[object Boolean]"]=ee["[object DataView]"]=ee["[object Date]"]=ee["[object Error]"]=ee["[object Function]"]=ee["[object Map]"]=ee["[object Number]"]=ee["[object Object]"]=ee["[object RegExp]"]=ee["[object Set]"]=ee["[object String]"]=ee["[object WeakMap]"]=!1;var re="object"==typeof exports&&exports&&!exports.nodeType&&exports,oe=re&&"object"==typeof module&&module&&!module.nodeType&&module,ie=oe&&oe.exports===re&&n.process,ue=function(){try{var t=oe&&oe.require&&oe.require("util").types;return t||ie&&ie.binding&&ie.binding("util")}catch(t){}}(),ae=ue&&ue.isTypedArray,ce=ae?ne(ae):function(t){return v(t)&&_t(t.length)&&!!ee[y(t)]},fe=Object.prototype.hasOwnProperty;function se(t,n){var r=e(t),o=!r&&Qt(t),i=!r&&!o&&te(t),u=!r&&!o&&!i&&ce(t),a=r||o||i||u,c=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],f=c.length;for(var s in t)!n&&!fe.call(t,s)||a&&("length"==s||i&&("offset"==s||"parent"==s)||u&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||At(s,f))||c.push(s);return c}var le=Object.prototype;var pe=function(t,e){return function(n){return t(e(n))}}(Object.keys,Object),he=pe,ye=Object.prototype.hasOwnProperty;function ve(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||le))return he(t);var e,n,r=[];for(var o in Object(t))ye.call(t,o)&&"constructor"!=o&&r.push(o);return r}function de(t){return jt(t)?se(t):ve(t)}var ge=function(t,e){return function(n,r){if(null==n)return n;if(!jt(n))return t(n,r);for(var o=n.length,i=e?o:-1,u=Object(n);(e?i--:++i<o)&&!1!==r(u[i],i,u););return n}}((function(t,e){return t&&Ht(t,e,de)})),be=ge;function _e(t){return t}function je(t,n){var r;return(e(t)?Dt:be)(t,"function"==typeof(r=n)?r:_e)}function me(t){return"[object String]"===Object.prototype.toString.call(t)}function we(t){return!(!me(t)||""===t)}function Ae(t){let e=!1;if(we(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(function(t){return t!=t}(t))return!1;e=!0}return e}function xe(t){if(!Ae(t))return 0;return $t(t)}function Oe(t){return!!Ae(t)&&(t=xe(t),"number"==typeof(e=t)&&e==It(e));var e}var Se=o.isFinite,Ue=Math.min;var Be=function(t){var e=Math[t];return function(t,n){if(t=kt(t),(n=null==n?0:Ue(It(n),292))&&Se(t)){var r=(ct(t)+"e").split("e");return+((r=(ct(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round"),Ce=Be;function ze(t){if(!Ae(t))return 0;t=xe(t);let e=Ce(t);return"0"===String(e)?0:e}let Te="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Pe=Te.length;function ke(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];var n;t=Oe(n=t)&&ze(n)>0?ze(t):32;for(let n=0;n<t;n++)e[n]=Te[0|Math.random()*Pe];return e.join("")}function Ee(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function Me(t){return"[object Uint16Array]"===Object.prototype.toString.call(t)}function $e(t){if(!Oe(t))return!1;return ze(t)>=0}function Ie(t,e){return we(t)&&$e(e)?0===(e=ze(e))?"":t.substring(0,e):""}function Le(t,e){return we(t)&&$e(e)?0===(e=ze(e))?t:function(t,e){if(!we(t))return"";if(!$e(e))return"";if(0===(e=ze(e)))return"";let n=t.length-e;return n<0&&(n=0),t.substr(n,e)}(t,t.length-e):""}var Fe={},Ne={get exports(){return Fe},set exports(t){Fe=t}};var Re,De={},We={get exports(){return De},set exports(t){De=t}},He=yt(Object.freeze({__proto__:null,default:{}}));function qe(){return Re||(Re=1,function(t,e){var n;t.exports=(n=n||function(t,e){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==ht&&ht.crypto&&(n=ht.crypto),!n)try{n=He}catch(t){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={},u=i.lib={},a=u.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},c=u.WordArray=a.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,o=t.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var u=n[i>>>2]>>>24-i%4*8&255;e[r+i>>>2]|=u<<24-(r+i)%4*8}else for(var a=0;a<o;a+=4)e[r+a>>>2]=n[a>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(r());return new c.init(e,t)}}),f=i.enc={},s=f.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],o=0;o<n;o++){var i=e[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new c.init(n,e/2)}},l=f.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],o=0;o<n;o++){var i=e[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new c.init(n,e)}},p=f.Utf8={stringify:function(t){try{return decodeURIComponent(escape(l.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return l.parse(unescape(encodeURIComponent(t)))}},h=u.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n,r=this._data,o=r.words,i=r.sigBytes,u=this.blockSize,a=i/(4*u),f=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*u,s=t.min(4*f,i);if(f){for(var l=0;l<f;l+=u)this._doProcessBlock(o,l);n=o.splice(0,f),r.sigBytes-=s}return new c.init(n,s)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});u.Hasher=h.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new y.HMAC.init(t,n).finalize(e)}}});var y=i.algo={};return i}(Math),n)}(We)),De}!function(t,e){var n;t.exports=(n=qe(),function(){var t=n,e=t.lib.WordArray;function r(t,n,r){for(var o=[],i=0,u=0;u<n;u++)if(u%4){var a=r[t.charCodeAt(u-1)]<<u%4*2|r[t.charCodeAt(u)]>>>6-u%4*2;o[i>>>2]|=a<<24-i%4*8,i++}return e.create(o,i)}t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp();for(var o=[],i=0;i<n;i+=3)for(var u=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<n;a++)o.push(r.charAt(u>>>6*(3-a)&63));var c=r.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(t){var e=t.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var u=n.charAt(64);if(u){var a=t.indexOf(u);-1!==a&&(e=a)}return r(t,e,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)}(Ne);var Ve=Fe,Je={};!function(t,e){var n;t.exports=(n=qe(),function(){if("function"==typeof ArrayBuffer){var t=n.lib.WordArray,e=t.init,r=t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var n=t.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=t[o]<<24-o%4*8;e.call(this,r,n)}else e.apply(this,arguments)};r.prototype=t}}(),n.lib.WordArray)}({get exports(){return Je},set exports(t){Je=t}});var Ge=Je;function Ke(t){if(!Ee(t))return"";return Ge.create(t).toString(Ve)}function Qe(t){if(!me(t))return new Uint8Array;let e=Ve.parse(t),n=e.words,r=e.sigBytes,o=new Uint8Array(r);for(let t=0;t<r;t++){let e=n[t>>>2]>>>24-t%4*8&255;o[t]=e}return o}function Xe(t){return Me(t)?Ke(function(t){return Me(t)?new Uint8Array(t):new Uint8Array}(t)):""}function Ye(t){if(!me(t))return new Uint16Array;let e=function(t){return Ee(t)?new Uint16Array(t):new Uint16Array}(Qe(t));return e}let Ze="[Uint8Array]::";let tn="[Uint16Array]::";let en={tagU8A:Ze,u8arr2b64:function(t){return Ee(t)?Ze+Ke(t):t},b642u8arr:function(t){return me(t)&&Ie(t,Ze.length)===Ze?Qe(t=Le(t,Ze.length)):t},tagU16A:tn,u16arr2b64:function(t){return Me(t)?tn+Xe(t):t},b642u16arr:function(t){return me(t)&&Ie(t,tn.length)===tn?Ye(t=Le(t,tn.length)):t}};function nn(t){return"[object Array]"===Object.prototype.toString.call(t)}function rn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Uint8Array";if(n=t,"[object Undefined]"===Object.prototype.toString.call(n))return"";var n;if(me(e))e=[e];else if(!nn(e))return"";let r="";try{r=JSON.stringify(t,(function(t,n){return e.indexOf("Uint8Array")>=0&&(n=en.u8arr2b64(n)),e.indexOf("Uint16Array")>=0&&(n=en.u16arr2b64(n)),n}))}catch(t){r=""}return r}function on(t,e,n,r,o){let i=function(t,e,n){e=(n?xt(t,e,n):void 0===e)?1:Ft(It(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var o=0,i=0,u=Array(Lt(r/e));o<r;)u[i++]=gt(t,o,o+=e);return u}(rn(n),e),u=ke(),a=i.length;je(i,(function(e,n){e=Rt(e,"");let i=`${u}|${n}|${a}|${e}`;t.send(i,(function(t){t&&O(o)&&o(t)})),O(r)&&r((n+1)/a*100)}))}var un=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function an(t){return un.test(t)}var cn=ue&&ue.isRegExp,fn=cn?ne(cn):function(t){return v(t)&&"[object RegExp]"==y(t)};var sn="\\ud800-\\udfff",ln="["+sn+"]",pn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",hn="\\ud83c[\\udffb-\\udfff]",yn="[^"+sn+"]",vn="(?:\\ud83c[\\udde6-\\uddff]){2}",dn="[\\ud800-\\udbff][\\udc00-\\udfff]",gn="(?:"+pn+"|"+hn+")"+"?",bn="[\\ufe0e\\ufe0f]?",_n=bn+gn+("(?:\\u200d(?:"+[yn,vn,dn].join("|")+")"+bn+gn+")*"),jn="(?:"+[yn+pn+"?",pn,vn,dn,ln].join("|")+")",mn=RegExp(hn+"(?="+hn+")|"+jn+_n,"g");function wn(t){return an(t)?function(t){return t.match(mn)||[]}(t):function(t){return t.split("")}(t)}var An=4294967295;function xn(t,e,n){return n&&"number"!=typeof n&&xt(t,e,n)&&(e=n=void 0),(n=void 0===n?An:n>>>0)?(t=ct(t))&&("string"==typeof e||null!=e&&!fn(e))&&!(e=at(e))&&an(t)?(r=wn(t),o=0,i=n,u=r.length,i=void 0===i?u:i,!o&&i>=u?r:gt(r,o,i)):t.split(e,n):[];var r,o,i,u}var On=Math.ceil,Sn=Math.max;var Un=function(t){return function(e,n,r){return r&&"number"!=typeof r&&xt(e,n,r)&&(n=r=void 0),e=$t(e),void 0===n?(n=e,e=0):n=$t(n),function(t,e,n,r){for(var o=-1,i=Sn(On((e-t)/(n||1)),0),u=Array(i);i--;)u[r?i:++o]=t,t+=n;return u}(e,n,r=void 0===r?e<n?1:-1:$t(r),t)}}(),Bn=Un;function Cn(t,e){return n=t,"[object Object]"===Object.prototype.toString.call(n)&&(!(!we(e)&&!Ae(e))&&e in t);var n}let zn={};function Tn(t,e){let n=xn(t,"|"),r=n[0],o=kt(n[1]),i=kt(n[2]),u=Rt((c=3,(s=null==(a=n)?0:a.length)?gt(a,(c=f||void 0===c?1:It(c))<0?0:c,s):[]),"|");var a,c,f,s;if(Cn(zn,r)||(zn[r]={}),zn[r]["_"+o]=u,o===i-1){let t="";je(Bn(i),(function(e){t+=zn[r]["_"+e]})),delete zn[r];let n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Uint8Array";if(me(e))e=[e];else if(!nn(e))return{};let n={};try{n=JSON.parse(t,(function(t,n){return e.indexOf("Uint8Array")>=0&&(n=en.b642u8arr(n)),e.indexOf("Uint16Array")>=0&&(n=en.b642u16arr(n)),n}))}catch(t){n={}}return n}(t);e(n)}}return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.port||(e.port=8080),e.strSplitLength||(e.strSplitLength=1e6);let n=new dt;function r(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];setTimeout((()=>{n.emit(t,...r)}),1)}let o={port:e.port,perMessageDeflate:{zlibDeflateOptions:{chunkSize:1024,memLevel:7,level:3},zlibInflateOptions:{chunkSize:10240},clientNoContextTakeover:!0,serverNoContextTakeover:!0,serverMaxWindowBits:10,concurrencyLimit:10,threshold:1024}},i=null;try{i=new t.WebSocketServer(o)}catch(t){u({msg:"can not create websocket",err:t})}if(!i)return n;function u(t){r("error",t)}function a(){r("clientChange",c)}r("open");let c=[];return i.on("connection",(function(o,i){function f(n,r){o.readyState===t.OPEN&&on(o,e.strSplitLength,n,r,(function(t){u({msg:"can not send message",err:t})}))}function s(t){let e=pt(t,"_mode","");if("execute"===e){r("execute",pt(t,"func",""),pt(t,"input"),(function(e){t.output=e,delete t.input,f(t,null)}),f)}else"broadcast"===e?r("broadcast",pt(t,"data")):"deliver"===e?r("deliver",pt(t,"data")):u({msg:"can not find _mode in data",err:t})}c.push(o),a(),o.on("close",(function(){c=c.filter((function(t){return t!==o})),a()})),o.sendData=f,o.on("message",(function(t){Tn(t,s)})),n.on("triggerBroadcast",(function(t,e){f({_mode:"broadcast",data:t},e)}))})),n.broadcast=function(t){r("triggerBroadcast",t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){})},n}}));
//# sourceMappingURL=w-converws-server.umd.js.map
